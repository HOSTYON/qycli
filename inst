#!/bin/bash

## Install qycli and stack with "wget -qO- qyc.li/inst | bash"
prod() {
    wget -qO /usr/bin/qyc qyc.li/bin/qyc && chmod 755 /usr/bin/qyc
    wget -qO /opt/qycli/inst qyc.li/inst
    wget -qO /opt/qycli/bin/stk qyc.li/bin/stk
    wget -qO /opt/qycli/bin/help qyc.li/bin/help
    wget -qO /opt/qycli/bin/fn qyc.li/bin/fn
    source /opt/qycli/stk
    source /opt/qycli/help
    printf "\nqycli (production) was installed.\n\nInstalling the stack now.\n\n"
    stk_wp
}

## Install qycli dev version with "wget -qO- qyc.li/inst | bash -s dev"
dev() {
    if ! command -v svn &> /dev/null; then
        apt update && apt -y install subversion
    fi
    svn export --force https://github.com/HOSTYON/qycli/trunk /opt/qycli/
    mv /opt/qycli/bin/qyc /usr/bin/qyc && chmod 755 /usr/bin/qyc
    printf "\nqycli (dev) was installed/updated.\n\n"
}

if [[ "$1" == "prod" || "$1" == "" ]]; then
    wget -qO- qyc.li/host | bash
    prod
elif [[ "$1" == "dev" ]]; then
    wget -qO- qyc.li/host | bash
    dev
fi
